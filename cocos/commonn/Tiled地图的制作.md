# 附录B Tiled地图的制作

Tiled地图编辑器是一个以普遍使用为目标的地图编辑器，它容易使用并且容易在不同的引擎中使用，目前它的最新版本是使用Qt框架开发的，目前最新稳定版本是1.1.6，下载地址：http://www.mapeditor.org/，下面我们就来一步步地讲解如何使用Tiled地图编辑器编辑地图。

选择“文件-新文件”新建地图工程，在弹出的对话框中设置地图的高度和宽度，图素块的大小，以及地图的方向。另外，新版本中提供了tmx文件的输出格式，包括XML格式、CVS（Comma Separated Value，逗号分隔值）以及之前提供的“Base64”加密模式（包含GNUzip压缩格式和zlib压缩格式），我们依然选择之前版本中默认的“Base64”加密模式和GNUzip压缩格式。选择界面如图B-1所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161919.jpg)

图B-1 新建地图

1）选择“新建Tiled集”或者是向编辑器拖入图素文件，在弹出的对话框中设置图素块的大小、边距和偏移量等，如图B-2所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161920.jpg)

图B-2 倒入图素文件

2）选择完成图素块后，左下角的部分就显示了目前的图素图块，选择相应图块便可以填充某图素块了。如图B-3所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161921.jpg)

图B-3 图素块区域

3）点击自定义属性下的“+”添加属性，弹出如图B-4所示对话框，图素的数据可以在程序中获得。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161922.jpg)

图B-4 添加图块属性

4）选择如图B-5所示的工具栏的不同工具填充，包括图章刷、填充、橡皮擦和选择矩形区域等，可以使用图章刷为每个格填充图素，填充是批量的填充图素，橡皮擦可以擦掉之前的填充图素。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161923.jpg)

图B-5 填充图素工具

5）屏幕的右上角显示图层编辑部分，如图B-6所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161924.jpg)

图B-6 图层编辑部分

6）通过图层编辑部分可以选择我们需要编辑的图层，并且可以排除其他层的干扰，如下如图B-7所示是图层编辑部分的按键，包括新建层、改变层之间的顺序、复制图层以及删除图层等按钮。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161925.jpg)

图B-7 图层编辑部分按钮

7）另外如图B-8所示，选择菜单中的图层部分也可以帮助编辑修改图层。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161926.jpg)

图B-8 图层菜单

8）关于地图的参数也可以在地图菜单中修改，如图B-9所示为地图菜单。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161927.jpg)

图B-9 地图菜单

9）可以通过视图菜单来修改地图在编辑器中的缩放比例，如图B-10所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161928.jpg)

图B-10 视图菜单

10）最后通过另存为可以把tmx文件存在你指定的位置，如图B-11所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161929.jpg)

图B-11 另存为界面

一块一块编辑地形有时会显得不是很方便，因为我们往往会做一些“重复工作”，比如有些城墙地图块需要“拐角”和“墙体”拼接而成，这个拼接过程其实是没有什么“技术含量”的工作，另外有时候我们要赋予这个地形以一定意义，我们就不用把它涉及的所有地图图素都加上属性，而是把它们当作一类来处理，这时就需要一个功能来规划这些图块，于是从0.9.0版本开始，Tiled编辑器支持地形功能，方法是点击地形选项卡，进入地形编辑界面，如图B-12所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161930.jpg)

图B-12 地形编辑界面

点击左下方的加号增加地形，减号删除地形，在选中某个地形的状态下可以点击图片上的图素设置地形，可以以图素四分之一大小设置地形，如果不小心设置错误，可以使用撤销按钮或者按下清除按钮，这时你再次点击某个块就是去除地形的标记。右击该地形就弹出可以设置地形属性的选项，选择它就可以进入地形属性编辑界面，和图素数据是一样的界面，如图B-13所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161931.jpg)

图B-13 地形属性编辑

地形设置完毕，关闭地形编辑界面，选择下方的地形选项卡就可以看到目前编辑的地形了，如图B-14所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161932.jpg)

图B-14 地形选择窗口

选择界面上方填充工具中的图片小图标就可以进入地形填充方式，填充的地形如图B-15所示。上下两块石地是同一块地形。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161933.jpg)

图B-15 地形编辑结果

另外一个提高大家工作效率的工具就是迷你地图工具，在大家编辑大号地图的时候可以选择某一块的地图进行编辑，还可以滑动滚轮来修改这个范围的大小，迷你地图如图B-16所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161934.jpg)

图B-16 迷你地图窗口

在Tiled地图编辑器中还有一个功能就是可以给地图添加精灵层，点击新建层按键便可以选择添加精灵层，如图B-17所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161935.jpg)

图B-17 添加对象层

精灵层中摆放对象位置可以精确到像素，可以在精灵层中加入图素和图形等，如图B-18所示，是精灵层可以使用的按钮。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161936.jpg)

图B-18 向对象层中加入对象

右键选择对象对象属性就可以修改对象的属性，如图B-19所示。

![img](https://gitee.com/nlpleaf/PicGo/raw/master/20200707161937.jpg)

图B-19 修改对象属性

你可以把精灵层理解为没有图素格限制的地图层，精灵层常常被用于放置场景中的大图素以及场景中的机关等，属于不受大小位置限制的图素。